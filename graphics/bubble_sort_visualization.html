<div id="chart"></div>
<button onclick="startSort()">Start Bubble Sort</button>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
const data = [5, 2, 7, 1, 3];
const width = 300, height = 150;

const svg = d3.select("#chart")
  .append("svg")
  .attr("width", width)
  .attr("height", height);

function draw(data) {
  const bars = svg.selectAll("rect").data(data);

  bars.enter()
      .append("rect")
      .merge(bars)
      .attr("x", (d,i) => i * 50)
      .attr("y", d => height - d*20)
      .attr("width", 40)
      .attr("height", d => d*20)
      .attr("fill", "steelblue")
      .transition().duration(500);

  bars.exit().remove();
}

draw(data);

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function startSort() {
  for(let i=0;i<data.length;i++){
    for(let j=0;j<data.length-i-1;j++){
      if(data[j] > data[j+1]){
        // swap
        [data[j], data[j+1]] = [data[j+1], data[j]];
        draw(data);          // update chart
        await sleep(600);    // pause to show animation
      }
    }
  }
}
</script>
